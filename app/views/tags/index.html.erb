<% @sub_menu = :tags %>

<article>
	<%= form_for @search do |f| %>
		<fieldset>
			<legend>Search</legend>
			<dl class="inline">
				<%= render :partial => 'tags/search_dl', :locals => {:f => f} %>
			</dl>
			<div class="buttons">
				<%= f.submit 'Search', :class => "button" %>
				<%= link_to 'Print Result', url_for(request.params.merge(:format => :pdf)), :class => 'button' %>
			</div>
		</fieldset>
	<% end %>
</article>

<article>
	<h1>All Tags</h1>
	
	<!-- <h2>Standard Table</h2> -->
	
	<table class="gtable detailtable">
		<thead>
			<tr>
				<th>Tag #</th>
				<th>Item #</th>
				<th>Location</th>
				<th>Cost</th>
				<th>Action</th>
			</tr>
		</thead>
		
		<tbody>
			<% @tags.each do |tag| %>
			<% next unless tag.inventory %>
			<tr>
				<td><%= tag.id %></td>
				<td><%= tag.inventory.item.try(:code) %> <a href="#" class="detail-link">more</a></td>
				<td><%= tag.inventory.location.try(:code) %></td>
				<td><%=number_to_currency (tag.inventory.item.try(:cost) || 0) %></td>
				<td>
					<% if curr_check.state == 'open' %>
					<%= link_to image_tag('icons/edit.png'), edit_tag_path(tag), :title => 'Edit' %>
					<%= link_to image_tag('icons/cross.png'), tag_path(tag), :method => :delete, :confirm => "Are you sure to delete Tag #{tag.id}?", :title => 'Delete' %>
					<% end %>
					<%= link_to image_tag('icons/printer.png'), tags_path(:search => {:id_eq => tag.id}, :format => :pdf), :title => 'Print' %>
				</td>
			</tr>
			<tr class="detail">
				<td colspan="5">
					<table>
						<tbody>
							<tr>
								<td><%= tag.inventory.item.try(:description) %></td>
							</tr>
						</tbody>
					</table>
				</td>
			</tr>
			<% end %>

		</tbody>
	</table>
	
	<div class="tablefooter clearfix">
		<%= will_paginate @tags %>
	</div>
</article>